<p align="center">
  <img width="460" height="300" src="visualitiona/figures/malware_cloud.png">
</p>
# ** Predicing Internet of Things(IoT Malware Attacks)**

#  Business Understanding

There is an exponential growth of Internet of Things (IoT) devices connected to the internet used by both cosumers and enterprises. By end of 2020, ~31 billion devices are connected and will double in the next  uears. The pervaisve nature of these devices and also with minimum security protection, spammers and scammerers have been launching botnets and malwares easily found in opensource. More than 2/3rd of enterprise networks had experienced cyber attacks on IoT devices. 

IoT networks have become an increasingly valuable target of malicious attacks due to the increased amount of valuable user data they contain.
Botnet-powered distributed denial of service (DDoS) attacks have used infected IoT devices to bring down websites. IoT devices can be used to direct other attacks. For instance, there may be future attempts to weaponize IoT devices. A possible example would be a nation shutting down home thermostats in an enemy state during a harsh winter. In response, network intrusion detection systems have been developed to detect suspicious network activity. Routers are trained to identify cyber threats.


To mitigate the challenges, beyond the router capabilities to detect DDoS and traffic anamolies, you also need the learning from the past attack. For this this study, I will explore how Machine Learning can accurately predict if a given traffic instanc is infected with malware attack

# Data Understanding
In 2016, there was a major botnet attack on IoT devices which crippled networks in several part of the world. One such malware is "Mirai". Prior experimental studies on the detection of IoT botnets or IoT traffic anomalies typically relied on emulated or simulated data. A better source of actual data collected during "Mirai" and 'Bashlite" botnet attacks on IoT devices are available at UCI Machine Learning Repository.

<sup>1</sup> "detection_of_IoT_botnet_attacks_N_BaIoT " (https://archive.ics.uci.edu/ml/datasets/detection_of_IoT_botnet_attacks_N_BaIoT#)

Thiss  dataset enables empirical evaluation with *real* traffic data, gathered from nine commercial IoT devices infected by authentic botnets from two families in an isolated network. It facilitates the examination of Mirai and BASHLITE, two of the most common IoT-based botnets, which have already demonstrated their harmful capabilities.

Approximately 7.5GB of datasets are organized for 9 different types of common IoT devices such as doorbells, security monitors, webcam, and baby monitors. For each of the botnet, a separate directory consist of traffic data collected on various ports.

# Data Preparation

Data was downloaded to 'data' directory under this project. Due to size of the dataset, it is recommended to download from UCI ML Repository.

For dataexploration, I read all the files and is availabe as EDA.ipynb under exploratory directory.

For the model training and testing, I took all normal traffic and equal number of  malware traffic was mixed from 'Mirai' and 'Bashlite' data. Datasets are shuffled and sampled to avoid any patterns in selecting observations

Because of the large datasets, I decided to store that in a class after sampling and **pickle** a class instance of data and results for each device stored under data-prep directory. If a pickle file is not already created for a device, i would create newone or read the pickle file firest to instantiate a class object for quick modeling. 

The sample dataset is then split to Training and Test data keeping the Test data for the final testing as the unseen holdout data.

For model training, a seconday split was done as Training and Validation tests.

# Model Selection and Development
For training and testing predicting malware attacks, I used a host of classification models such as Logistic Regression, Decision Tree, KNN Classifier, Random Forest, and XGBoost models. To compare the performance of each model, I selected "Recall" and "Accuracy" as measures.

Recall is the most important to score, because i wanted to minimize the number of False Negatives which would mean a malware infected traffic data is considered a normal one. Accuracy reflects the over all performance of teh model.

While training and testing the model, ** Confustion Matrix *** was created for every deice for testing and validation sets and stored as charts under 'visualization' directory.

Finally, the model is tested on the 30% holdout data as the final result.


# Model Evaluation

Although all the models had good predictive scores, I chose between Decision Tree, Random Forest, and XGBoost. Random Forest was computationally expensive, so selcted XGBoost as the final model, because the use of gradient decent algorithm and ease of training. 

The overall success rate was 100% for both Recall and Accuracy.


# Business Deployment

The IoT Malware Attack predictive model can be used with newly discovered data to identify malware attack patterns.

To run the model, 


# Summary

Internet of Things is pervasive and it will consume network traffic at home and work. As these devices have very little resources to test a malware attack, networks should become more intelligent to identify future attacks. A Machine Learning predicting algorithms can aid in identifying a pattern in the traffic to prevent futer malware attacks.

## Appendix
'''
% ls -R IoT_Malware_Attacks | grep ':$' | sed -e 's/:$//' -e 's/[^\/]*\//|  /g' -e 's/|  \([^|]\)/|–– \1/g'
|–– data ------------------------------------------> 9 devices and each subdirectory contains traffic datasets
|  |–– Damini_Doorbell
|  |  |–– gafgyt_attacks
|  |  |–– mirai_attacks
|  |–– Ecobee_Thermostat
|  |  |–– gafgyt_attacks
|  |  |–– mirai_attacks
|  |–– Ennino_Doorbell
|  |  |–– gafgyt_attacks
|  |  |–– mirai_attacks
|  |–– Philips_B120N10_Baby_Monitor
|  |  |–– gafgyt_attacks
|  |  |–– mirai_attacks
|  |–– Provision_PT_737E_Security_Camera
|  |  |–– gafgyt_attacks
|  |  |–– mirai_attacks
|  |–– Provision_PT_838_Security_Camera
|  |  |–– gafgyt_attacks
|  |  |–– mirai_attacks
|  |–– Samsung_SNH_1011_N_Webcam
|  |  |–– gafgyt_attacks
|  |–– SimpleHome_XCS7_1002_WHT_Security_Camera
|  |  |–– gafgyt_attacks
|  |  |–– mirai_attacks
|  |–– SimpleHome_XCS7_1003_WHT_Security_Camera
|  |  |–– gafgyt_attacks
|  |  |–– mirai_attacks
|–– data_prep
|–– notebooks
|  |–– exploratory ---------------------------------> Start here for index.ipynb. Use this to run models. EDA.ipynb does data exploratory work.
|  |–– final
|–– reports
|–– src --------------------------------------------> data_prep.pu, has a class ioT_Device and a mothod iot_Model, crux of the logic
|  |–– __pycache__
|–– visualization
'''

## References:
<sup>1</sup> "detection_of_IoT_botnet_attacks_N_BaIoT " (https://archive.ics.uci.edu/ml/datasets/detection_of_IoT_botnet_attacks_N_BaIoT#)

